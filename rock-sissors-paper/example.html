<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>가위바위보 게임</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #333;
            color: white;
        }
        .game-container {
            width: 100%;
            max-width: 400px;
            margin: 0 auto;
            height: 100vh;
            position: relative;
            overflow: hidden;
        }
        .frame {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            box-sizing: border-box;
            background-color: #3c3836;
            transition: transform 0.5s ease;
            transform: translateX(100%);
        }
        .frame.active {
            transform: translateX(0);
        }
        h1 {
            text-align: center;
            margin-bottom: 20px;
            font-size: 24px;
        }
        p {
            text-align: center;
            margin: 10px 0;
            font-size: 14px;
            line-height: 1.5;
        }
        .game-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            overflow-y: auto;
            padding-bottom: 160px; /* 점수판 높이만큼 여백 */
        }
        .choices {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            margin: 20px 0;
            width: 100%;
        }
        .choice {
            width: 100px;
            height: 100px;
            border: none;
            border-radius: 50%;
            background-color: #3c3836;
            font-size: 50px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        .choice-label {
            background-color: #ffc0cb;
            color: black;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 14px;
            margin-top: 5px;
            text-align: center;
        }
        .rabbit {
            font-size: 40px;
            margin: 20px 0;
        }
        .speech-bubble {
            position: relative;
            background-color: white;
            border-radius: 20px;
            padding: 10px 15px;
            color: black;
            font-size: 14px;
            max-width: 200px;
            text-align: center;
            margin: 10px auto;
        }
        .speech-bubble:after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 0;
            height: 0;
            border: 10px solid transparent;
            border-top-color: white;
            border-bottom: 0;
            margin-left: -10px;
            margin-bottom: -10px;
        }
        .score-table {
            width: 100%;
            max-width: 300px;
            background-color: #ffccd5;
            color: black;
            border-radius: 10px 10px 0 0;
            padding: 10px;
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
        }
        .score-row {
            display: flex;
            justify-content: center;
            gap: 5px;
            margin: 5px 0;
        }
        .score-cell {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }
        .score-label {
            width: 20px;
            text-align: center;
            font-weight: bold;
        }
        .score-header {
            text-align: center;
            font-size: 14px;
            margin-bottom: 5px;
        }
        .btn-restart {
            background-color: #ff6b8b;
            color: white;
            border: none;
            border-radius: 20px;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 14px;
            margin-top: 10px;
        }
        .sparkle {
            font-size: 24px;
            position: absolute;
            animation: sparkle 1s infinite;
        }
        @keyframes sparkle {
            0% { opacity: 0; }
            50% { opacity: 1; }
            100% { opacity: 0; }
        }
    </style>
</head>
<body>
    <div class="game-container" id="game-container">
        <!-- 프레임 1: 인트로 -->
        <div class="frame active" id="frame1">
            <h1>가위바위보 게임</h1>
            <div class="game-content">
                <p>PLAYER님을 위한 특별한<br>가위바위보 게임을<br>컴퓨터와 대결하게 될 겁니다.<br>컴퓨터와의 대결에 준비하세요!</p>
                <div class="rabbit">🐰</div>
                <button class="btn-restart" onclick="showFrame(2)">시작하기</button>
            </div>
        </div>

        <!-- 프레임 2: 선택 화면 -->
        <div class="frame" id="frame2">
            <h1>가위바위보 게임</h1>
            <div class="game-content">
                <p>어떤것으로 게임 할지<br>선택해주세요!</p>
                <div class="choices">
                    <div>
                        <div class="choice" onclick="selectChoice('가위')">✌️</div>
                        <div class="choice-label">가위</div>
                    </div>
                    <div>
                        <div class="choice" onclick="selectChoice('바위')">✊</div>
                        <div class="choice-label">바위</div>
                    </div>
                    <div>
                        <div class="choice" onclick="selectChoice('보')">✋</div>
                        <div class="choice-label">보</div>
                    </div>
                </div>
            </div>
            <!-- 점수판은 공통 요소로 script에서 추가됨 -->
        </div>

        <!-- 프레임 3: 컴퓨터 선택 및 결과 화면 -->
        <div class="frame" id="frame3">
            <h1>가위바위보 게임</h1>
            <div class="game-content">
                <p>PLAYER의 선택</p>
                <div class="choice" id="user-choice-display">✌️</div>
                <div class="choice-label" id="user-choice-label">가위</div>
                
                <p>컴퓨터의 선택</p>
                <div class="choice" id="computer-choice-display">✊</div>
                <div class="choice-label" id="computer-choice-label">바위</div>
                
                <div class="rabbit">🐰</div>
                <div class="speech-bubble" id="result-message">졌습니다! ㅠ_ㅠ</div>
                
                <button class="btn-restart" onclick="nextRound()">다음게임</button>
            </div>
            <!-- 점수판은 공통 요소로 script에서 추가됨 -->
        </div>

        <!-- 프레임 4: 최종 결과 화면 -->
        <div class="frame" id="frame4">
            <h1>가위바위보 게임</h1>
            <div class="game-content">
                <div id="sparkles-container"></div>
                <div class="rabbit">🐰</div>
                <div class="speech-bubble" id="final-message">PLAYER의 승리! 축하합니다! ^^</div>
                <button class="btn-restart" id="restart-button" onclick="resetGame()">처음부터</button>
            </div>
            <!-- 점수판은 공통 요소로 script에서 추가됨 -->
        </div>
    </div>

    <script>
        // 게임 변수
        let currentFrame = 1;
        let gameResults = Array(10).fill(null); // 10판의 결과를 저장할 배열
        let currentRound = 0;
        let userChoice = '';
        let computerChoice = '';
        
        // 공통 점수판 생성
        function createScoreTable() {
            const scoreTable = document.createElement('div');
            scoreTable.className = 'score-table';
            scoreTable.id = 'score-table';
            
            const scoreHeader = document.createElement('div');
            scoreHeader.className = 'score-header';
            scoreHeader.textContent = '현재 승/패';
            scoreTable.appendChild(scoreHeader);
            
            // U 행 (플레이어)
            const uRow = document.createElement('div');
            uRow.className = 'score-row';
            
            const uLabel = document.createElement('div');
            uLabel.className = 'score-label';
            uLabel.textContent = 'U';
            uRow.appendChild(uLabel);
            
            for (let i = 1; i <= 10; i++) {
                const cell = document.createElement('div');
                cell.className = 'score-cell';
                cell.setAttribute('data-index', i);
                cell.textContent = i;
                uRow.appendChild(cell);
            }
            scoreTable.appendChild(uRow);
            
            // C 행 (컴퓨터)
            const cRow = document.createElement('div');
            cRow.className = 'score-row';
            
            const cLabel = document.createElement('div');
            cLabel.className = 'score-label';
            cLabel.textContent = 'C';
            cRow.appendChild(cLabel);
            
            for (let i = 1; i <= 10; i++) {
                const cell = document.createElement('div');
                cell.className = 'score-cell';
                cell.setAttribute('data-index', i);
                cell.textContent = i;
                cRow.appendChild(cell);
            }
            scoreTable.appendChild(cRow);
            
            return scoreTable;
        }
        
        // 프레임 전환 함수
        function showFrame(frameNumber) {
            const frames = document.querySelectorAll('.frame');
            frames.forEach(frame => {
                frame.classList.remove('active');
            });
            document.getElementById('frame' + frameNumber).classList.add('active');
            currentFrame = frameNumber;
            
            // 첫 번째 프레임을 제외한 모든 프레임에 점수판 추가
            if (frameNumber > 1) {
                updateScoreDisplay();
            }
        }
        
        // 사용자 선택 함수
        function selectChoice(choice) {
            userChoice = choice;
            computerChoice = getComputerChoice();
            
            // 이모지 매핑
            const choiceEmojis = {
                '가위': '✌️',
                '바위': '✊',
                '보': '✋'
            };
            
            // 화면에 선택 표시
            document.getElementById('user-choice-display').innerHTML = choiceEmojis[userChoice];
            document.getElementById('user-choice-label').textContent = userChoice;
            document.getElementById('computer-choice-display').innerHTML = choiceEmojis[computerChoice];
            document.getElementById('computer-choice-label').textContent = computerChoice;
            
            // 승패 결정
            const result = checkWinner(userChoice, computerChoice);
            let resultMessage = '';
            
            if (result === 'win') {
                resultMessage = '이겼습니다! ^^';
                gameResults[currentRound] = 'win';
            } else if (result === 'lose') {
                resultMessage = '졌습니다! ㅠ_ㅠ';
                gameResults[currentRound] = 'lose';
            } else {
                resultMessage = '비겼습니다! ^_^';
                gameResults[currentRound] = 'draw';
            }
            
            document.getElementById('result-message').textContent = resultMessage;
            currentRound++;
            
            // 결과 화면으로 전환
            showFrame(3);
            
            // 모든 라운드 종료 시 최종 결과 화면 준비
            if (currentRound >= 10) {
                prepareResultScreen();
            }
        }
        
        // 다음 라운드 함수
        function nextRound() {
            if (currentRound >= 10) {
                showFrame(4);
            } else {
                showFrame(2);
            }
        }
        
        // 컴퓨터 선택 함수
        function getComputerChoice() {
            const choices = ['가위', '바위', '보'];
            const randomIndex = Math.floor(Math.random() * 3);
            return choices[randomIndex];
        }
        
        // 승패 결정 함수
        function checkWinner(user, computer) {
            if (user === computer) {
                return 'draw';
            }
            
            if (
                (user === '가위' && computer === '보') ||
                (user === '바위' && computer === '가위') ||
                (user === '보' && computer === '바위')
            ) {
                return 'win';
            }
            
            return 'lose';
        }
        
        // 점수 표시 업데이트 함수
        function updateScoreDisplay() {
            // 기존 점수판 제거
            const oldScoreTable = document.getElementById('score-table');
            if (oldScoreTable) {
                oldScoreTable.remove();
            }
            
            // 새 점수판 생성
            const scoreTable = createScoreTable();
            document.getElementById('game-container').appendChild(scoreTable);
            
            // 점수 업데이트
            const userCells = scoreTable.querySelectorAll('.score-row:nth-child(2) .score-cell');
            const compCells = scoreTable.querySelectorAll('.score-row:nth-child(3) .score-cell');
            
            for (let i = 0; i < gameResults.length; i++) {
                if (gameResults[i] === null) continue;
                
                if (gameResults[i] === 'win') {
                    userCells[i].textContent = 'O';
                    userCells[i].style.color = 'blue';
                    compCells[i].textContent = 'X';
                    compCells[i].style.color = 'red';
                } else if (gameResults[i] === 'lose') {
                    userCells[i].textContent = 'X';
                    userCells[i].style.color = 'red';
                    compCells[i].textContent = 'O';
                    compCells[i].style.color = 'blue';
                } else if (gameResults[i] === 'draw') {
                    userCells[i].textContent = '-';
                    compCells[i].textContent = '-';
                }
            }
        }
        
        // 최종 결과 화면 준비 함수
        function prepareResultScreen() {
            let userWins = 0;
            let computerWins = 0;
            
            gameResults.forEach(result => {
                if (result === 'win') userWins++;
                if (result === 'lose') computerWins++;
            });
            
            let finalMessage = '';
            
            if (userWins > computerWins) {
                finalMessage = 'PLAYER의 승리! 축하합니다! ^^';
                createSparkles();
            } else if (userWins < computerWins) {
                finalMessage = 'PLAYER의 패배! 다음에 또 도전하세요! ㅠ_ㅠ';
            } else {
                finalMessage = '무승부! 다시 도전해보세요! ^_^';
            }
            
            document.getElementById('final-message').textContent = finalMessage;
        }
        
        // 반짝이 효과 생성 함수
        function createSparkles() {
            const container = document.getElementById('sparkles-container');
            container.innerHTML = '';
            
            for (let i = 0; i < 10; i++) {
                const sparkle = document.createElement('div');
                sparkle.className = 'sparkle';
                sparkle.textContent = '✨';
                sparkle.style.left = Math.random() * 80 + 10 + '%';
                sparkle.style.top = Math.random() * 80 + 10 + '%';
                sparkle.style.animationDelay = Math.random() * 2 + 's';
                container.appendChild(sparkle);
            }
        }
        
        // 게임 리셋 함수
        function resetGame() {
            gameResults = Array(10).fill(null);
            currentRound = 0;
            
            // 점수판 초기화
            const oldScoreTable = document.getElementById('score-table');
            if (oldScoreTable) {
                oldScoreTable.remove();
            }
            
            showFrame(1);
        }
        
        // 초기화
        document.addEventListener('DOMContentLoaded', function() {
            resetGame();
        });
    </script>
</body>
</html>